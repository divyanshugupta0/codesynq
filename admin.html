<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CodeSynq Admin Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --error-color: #ef4444;
            --info-color: #3b82f6;
            --bg-primary: #ffffff;
            --bg-secondary: #f8f9fa;
            --bg-tertiary: #e9ecef;
            --text-primary: #1f2937;
            --text-secondary: #6b7280;
            --border-color: #e5e7eb;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px rgba(0, 0, 0, 0.1);
            --radius-sm: 6px;
            --radius-md: 10px;
            --radius-lg: 15px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        [data-theme="dark"] {
            --bg-primary: #1a1a2e;
            --bg-secondary: #16213e;
            --bg-tertiary: #0f3460;
            --text-primary: #e5e7eb;
            --text-secondary: #9ca3af;
            --border-color: #374151;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-secondary);
            color: var(--text-primary);
            min-height: 100vh;
            transition: var(--transition);
            user-select: none;
        }

        /* Top Navigation Bar */
        .top-nav {
            background: var(--bg-primary);
            border-bottom: 1px solid var(--border-color);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow-sm);
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo {
            width: 40px;
            height: 40px;
            background: var(--primary-gradient);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.05);
            }
        }

        .logo-text h1 {
            font-size: 1.5rem;
            font-weight: 700;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-text p {
            font-size: 0.75rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .nav-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .theme-toggle,
        .logout-btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            font-size: 0.875rem;
        }

        .theme-toggle {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .theme-toggle:hover {
            background: var(--bg-tertiary);
            transform: translateY(-2px);
        }

        .logout-btn {
            background: var(--primary-gradient);
            color: white;
        }

        .logout-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .admin-user {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 0.5rem 1rem;
            background: var(--bg-secondary);
            border-radius: var(--radius-md);
        }

        .user-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: var(--primary-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
        }

        .user-info {
            display: flex;
            flex-direction: column;
        }

        .user-name {
            font-size: 0.875rem;
            font-weight: 600;
        }

        .user-role {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        /* Main Container */
        .admin-container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 2rem;
        }

        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--bg-primary);
            padding: 1.5rem;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--primary-gradient);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-xl);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 800;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            font-weight: 500;
            margin-top: 0.5rem;
        }

        .stat-change {
            font-size: 0.75rem;
            margin-top: 0.5rem;
            padding: 0.25rem 0.5rem;
            border-radius: var(--radius-sm);
            display: inline-block;
        }

        .stat-change.positive {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success-color);
        }

        .stat-change.negative {
            background: rgba(239, 68, 68, 0.1);
            color: var(--error-color);
        }

        /* Main Content Area */
        .content-area {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .section-card {
            background: var(--bg-primary);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
            overflow: hidden;
        }

        .section-header {
            padding: 1.5rem;
            background: var(--primary-gradient);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .section-header h2 {
            font-size: 1.25rem;
            font-weight: 700;
        }

        .section-badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 0.25rem 0.75rem;
            border-radius: 50px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .section-content {
            padding: 1.5rem;
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.875rem;
        }

        .form-input,
        .form-textarea,
        .form-select {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid var(--border-color);
            border-radius: var(--radius-md);
            font-size: 0.875rem;
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: var(--transition);
            font-family: inherit;
        }

        .form-input:focus,
        .form-textarea:focus,
        .form-select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        /* Buttons */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: var(--radius-md);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.875rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-family: inherit;
        }

        .btn-primary {
            background: var(--primary-gradient);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--bg-tertiary);
        }

        .btn-block {
            width: 100%;
            justify-content: center;
        }

        /* Activity Feed */
        .activity-item {
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
            transition: var(--transition);
            cursor: pointer;
        }

        .activity-item:hover {
            background: var(--bg-secondary);
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 0.5rem;
        }

        .activity-user {
            font-weight: 600;
            font-size: 0.875rem;
        }

        .activity-time {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .activity-description {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        /* User Management Table */
        .users-table {
            width: 100%;
            border-collapse: collapse;
        }

        .users-table thead {
            background: var(--bg-secondary);
        }

        .users-table th {
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .users-table td {
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
            font-size: 0.875rem;
        }

        .users-table tr:hover {
            background: var(--bg-secondary);
        }

        .user-status {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 0.5rem;
        }

        .user-status.online {
            background: var(--success-color);
            box-shadow: 0 0 10px var(--success-color);
        }

        .user-status.offline {
            background: var(--text-secondary);
        }

        .action-btns {
            display: flex;
            gap: 0.5rem;
        }

        .btn-sm {
            padding: 0.375rem 0.75rem;
            font-size: 0.75rem;
        }

        /* Notification Preview */
        .notification-preview {
            background: var(--bg-secondary);
            padding: 1.5rem;
            border-radius: var(--radius-md);
            border-left: 4px solid var(--primary-color);
            margin-top: 1rem;
        }

        .preview-title {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-bottom: 1rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .preview-notification {
            background: white;
            padding: 1rem;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
        }

        .preview-notification h3 {
            font-size: 1rem;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .preview-notification p {
            font-size: 0.875rem;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        /* Status Messages */
        .status-message {
            margin-top: 1rem;
            padding: 1rem 1.5rem;
            border-radius: var(--radius-md);
            font-weight: 600;
            display: none;
            align-items: center;
            gap: 0.75rem;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .status-message.success {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success-color);
            border: 1px solid var(--success-color);
        }

        .status-message.error {
            background: rgba(239, 68, 68, 0.1);
            color: var(--error-color);
            border: 1px solid var(--error-color);
        }

        .status-message.info {
            background: rgba(59, 130, 246, 0.1);
            color: var(--info-color);
            border: 1px solid var(--info-color);
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid var(--border-color);
        }

        .tab {
            padding: 0.75rem 1.5rem;
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 600;
            color: var(--text-secondary);
            transition: var(--transition);
            position: relative;
            font-family: inherit;
            font-size: 0.875rem;
        }

        .tab.active {
            color: var(--primary-color);
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--primary-gradient);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Search Bar */
        .search-bar {
            position: relative;
            margin-bottom: 1.5rem;
        }

        .search-input {
            width: 100%;
            padding: 0.75rem 1rem 0.75rem 3rem;
            border: 2px solid var(--border-color);
            border-radius: var(--radius-md);
            font-size: 0.875rem;
            background: var(--bg-primary);
            color: var(--text-primary);
        }

        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
        }

        /* Loading Animation */
        .loader {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* Notification History Items */
        .history-item {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 1.25rem;
            margin-bottom: 1rem;
            transition: var(--transition);
            position: relative;
        }

        .history-item:hover {
            border-color: var(--primary-color);
            box-shadow: var(--shadow-md);
            transform: translateX(5px);
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 0.75rem;
        }

        .history-title {
            font-size: 1rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .history-type-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 50px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .history-type-badge.info {
            background: rgba(59, 130, 246, 0.1);
            color: var(--info-color);
        }

        .history-type-badge.success {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success-color);
        }

        .history-type-badge.warning {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning-color);
        }

        .history-type-badge.error {
            background: rgba(239, 68, 68, 0.1);
            color: var(--error-color);
        }

        .history-message {
            color: var(--text-secondary);
            font-size: 0.875rem;
            line-height: 1.6;
            margin-bottom: 0.75rem;
        }

        .history-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-bottom: 0.75rem;
        }

        .history-meta-item {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .history-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn-delete {
            background: rgba(239, 68, 68, 0.1);
            color: var(--error-color);
            border: 1px solid var(--error-color);
            padding: 0.5rem 1rem;
            border-radius: var(--radius-sm);
            font-size: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .btn-delete:hover {
            background: var(--error-color);
            color: white;
            transform: translateY(-2px);
        }

        .history-link {
            color: var(--primary-color);
            text-decoration: none;
            font-size: 0.875rem;
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            margin-top: 0.5rem;
        }

        .history-link:hover {
            text-decoration: underline;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .content-area {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .admin-container {
                padding: 0 1rem;
            }

            .top-nav {
                padding: 1rem;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .logo-text h1 {
                font-size: 1.25rem;
            }

            .admin-user {
                display: none;
            }

            .users-table {
                font-size: 0.75rem;
            }

            .users-table th,
            .users-table td {
                padding: 0.5rem;
            }
        }

        /* Access Denied Screen - Hacker Style */
        .access-denied {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #000;
            overflow: hidden;
            z-index: 9999;
        }

        /* Matrix Rain Background */
        #matrix-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.3;
            z-index: 1;
        }

        .denied-content {
            position: relative;
            z-index: 2;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 2rem;
        }

        .terminal-window {
            background: rgba(0, 0, 0, 0.9);
            border: 2px solid #ff0000;
            border-radius: 10px;
            box-shadow: 0 0 30px rgba(255, 0, 0, 0.5), inset 0 0 20px rgba(255, 0, 0, 0.1);
            max-width: 700px;
            width: 100%;
            overflow: hidden;
            animation: terminalGlow 2s ease-in-out infinite alternate;
        }

        @keyframes terminalGlow {
            0% {
                box-shadow: 0 0 30px rgba(255, 0, 0, 0.5), inset 0 0 20px rgba(255, 0, 0, 0.1);
            }

            100% {
                box-shadow: 0 0 50px rgba(255, 0, 0, 0.8), inset 0 0 30px rgba(255, 0, 0, 0.2);
            }
        }

        .terminal-header {
            background: linear-gradient(180deg, #1a0000 0%, #000 100%);
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #ff0000;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .terminal-button {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #ff0000;
            box-shadow: 0 0 5px #ff0000;
        }

        .terminal-title {
            color: #ff0000;
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            margin-left: 1rem;
            text-shadow: 0 0 10px #ff0000;
        }

        .terminal-body {
            padding: 1.25rem 1.5rem;
            font-family: 'Courier New', monospace;
            color: #00ff00;
            background: radial-gradient(circle at center, rgba(0, 20, 0, 0.5) 0%, rgba(0, 0, 0, 0.9) 100%);
        }

        .access-denied-skull {
            font-size: 3rem;
            text-align: center;
            margin-bottom: 0.75rem;
            color: #ff0000;
            text-shadow: 0 0 20px #ff0000, 0 0 40px #ff0000;
            animation: skullPulse 1s ease-in-out infinite;
        }

        @keyframes skullPulse {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }
        }

        .access-denied-title {
            font-size: 2rem;
            color: #ff0000;
            text-align: center;
            margin-bottom: 1rem;
            text-shadow: 0 0 10px #ff0000;
            animation: glitch 1s linear infinite;
            position: relative;
        }

        @keyframes glitch {

            2%,
            64% {
                transform: translate(2px, 0) skew(0deg);
            }

            4%,
            60% {
                transform: translate(-2px, 0) skew(0deg);
            }

            62% {
                transform: translate(0, 0) skew(5deg);
            }
        }

        .terminal-text {
            color: #00ff00;
            font-size: 0.85rem;
            line-height: 1.6;
            margin-bottom: 1rem;
            text-shadow: 0 0 5px rgba(0, 255, 0, 0.5);
        }

        .terminal-command {
            color: #ffff00;
            margin: 0.5rem 0;
            display: flex;
            align-items: center;
            text-shadow: 0 0 5px rgba(255, 255, 0, 0.5);
        }

        .terminal-command::before {
            content: '$ ';
            color: #ff0000;
            margin-right: 0.5rem;
        }

        .typing-cursor {
            display: inline-block;
            width: 10px;
            height: 20px;
            background: #00ff00;
            margin-left: 5px;
            animation: blink 0.7s infinite;
        }

        @keyframes blink {

            0%,
            49% {
                opacity: 1;
            }

            50%,
            100% {
                opacity: 0;
            }
        }

        .error-code {
            background: rgba(255, 0, 0, 0.1);
            border: 1px solid #ff0000;
            border-left: 4px solid #ff0000;
            padding: 0.75rem;
            margin: 0.75rem 0;
            font-family: 'Courier New', monospace;
            color: #ff0000;
            text-shadow: 0 0 5px rgba(255, 0, 0, 0.5);
        }

        .error-code-title {
            font-weight: bold;
            margin-bottom: 0.25rem;
            font-size: 1rem;
        }

        .denied-btn {
            background: transparent;
            border: 2px solid #00ff00;
            color: #00ff00;
            padding: 0.75rem 2rem;
            font-family: 'Courier New', monospace;
            font-size: 1rem;
            cursor: pointer;
            margin-top: 1rem;
            transition: all 0.3s ease;
            text-shadow: 0 0 5px rgba(0, 255, 0, 0.5);
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.3);
            position: relative;
            overflow: hidden;
        }

        .denied-btn:hover {
            background: #00ff00;
            color: #000;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.8);
            text-shadow: none;
        }

        .denied-btn::after {
            content: ' ‚Üí';
        }

        .scan-line {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, #00ff00, transparent);
            animation: scan 3s linear infinite;
            opacity: 0.3;
            z-index: 3;
            pointer-events: none;
        }

        @keyframes scan {
            0% {
                transform: translateY(0);
            }

            100% {
                transform: translateY(100vh);
            }
        }

        .warning-messages {
            margin: 1rem 0;
            text-align: left;
        }

        .warning-line {
            color: #ff6600;
            margin: 0.35rem 0;
            font-size: 0.85rem;
            text-shadow: 0 0 5px rgba(255, 102, 0, 0.5);
        }

        .warning-line::before {
            content: '[!] ';
            color: #ff0000;
            font-weight: bold;
        }

        .access-info {
            display: grid;
            grid-template-columns: auto 1fr;
            gap: 0.35rem 1rem;
            margin: 0.75rem 0;
            padding: 0.75rem;
            background: rgba(255, 0, 0, 0.05);
            border: 1px solid rgba(255, 0, 0, 0.2);
            font-size: 0.85rem;
        }

        .access-info-label {
            color: #ff0000;
            font-weight: bold;
        }

        .access-info-value {
            color: #00ff00;
        }

        /* Side Notification Box */
        .attack-notification {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: rgba(0, 0, 0, 0.95);
            border: 2px solid #ff0000;
            border-radius: 8px;
            padding: 1.5rem;
            min-width: 350px;
            max-width: 400px;
            z-index: 10000;
            box-shadow: 0 0 30px rgba(255, 0, 0, 0.6), inset 0 0 20px rgba(255, 0, 0, 0.1);
            animation: slideInFromRight 0.5s ease-out, notificationGlow 2s ease-in-out infinite alternate;
            font-family: 'Courier New', monospace;
        }

        @keyframes slideInFromRight {
            from {
                transform: translateX(500px);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes notificationGlow {
            0% {
                box-shadow: 0 0 30px rgba(255, 0, 0, 0.6), inset 0 0 20px rgba(255, 0, 0, 0.1);
            }

            100% {
                box-shadow: 0 0 50px rgba(255, 0, 0, 0.9), inset 0 0 30px rgba(255, 0, 0, 0.2);
            }
        }

        .attack-notification-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
            color: #ff0000;
            font-weight: bold;
            font-size: 0.9rem;
            text-shadow: 0 0 10px rgba(255, 0, 0, 0.8);
        }

        .attack-icon {
            font-size: 1.2rem;
            animation: rotate 2s linear infinite;
        }

        @keyframes rotate {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }

        .attack-message {
            color: #00ff00;
            font-size: 0.85rem;
            margin-bottom: 1rem;
            line-height: 1.6;
            text-shadow: 0 0 5px rgba(0, 255, 0, 0.5);
        }

        .attack-target {
            color: #ffff00;
            font-weight: bold;
            word-break: break-all;
            text-shadow: 0 0 5px rgba(255, 255, 0, 0.5);
        }

        .progress-container {
            margin-top: 1rem;
        }

        .progress-label {
            color: #00ff00;
            font-size: 0.75rem;
            margin-bottom: 0.5rem;
            display: flex;
            justify-content: space-between;
            text-shadow: 0 0 5px rgba(0, 255, 0, 0.5);
        }

        .progress-bar-bg {
            width: 100%;
            height: 20px;
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid #00ff00;
            border-radius: 4px;
            overflow: hidden;
            box-shadow: inset 0 0 10px rgba(0, 255, 0, 0.2);
        }

        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ff00, #00cc00);
            width: 0%;
            transition: width 0.3s ease;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.8);
            position: relative;
            animation: progressPulse 1s ease-in-out infinite;
        }

        @keyframes progressPulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.8;
            }
        }

        .progress-bar-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 2s linear infinite;
        }

        @keyframes shimmer {
            0% {
                transform: translateX(-100%);
            }

            100% {
                transform: translateX(100%);
            }
        }

        .attack-status {
            margin-top: 0.75rem;
            padding: 0.5rem;
            background: rgba(255, 0, 0, 0.1);
            border-left: 3px solid #ff0000;
            color: #ff6600;
            font-size: 0.75rem;
            text-shadow: 0 0 5px rgba(255, 102, 0, 0.5);
        }

        @media (max-width: 768px) {
            .attack-notification {
                bottom: 1rem;
                right: 1rem;
                left: 1rem;
                min-width: auto;
                max-width: none;
            }
        }

        /* Second Attack Notification (Above First) */
        .attack-notification-2 {
            position: fixed;
            bottom: calc(2rem + 280px);
            /* Above first notification */
            right: 2rem;
            background: rgba(10, 0, 0, 0.95);
            border: 2px solid #ff6600;
            border-radius: 8px;
            padding: 1.5rem;
            min-width: 350px;
            max-width: 400px;
            z-index: 10001;
            box-shadow: 0 0 30px rgba(255, 102, 0, 0.6), inset 0 0 20px rgba(255, 102, 0, 0.1);
            animation: slideInFromRight 0.5s ease-out 2s both, notificationGlow2 2s ease-in-out infinite alternate 2s;
            font-family: 'Courier New', monospace;
        }

        @keyframes notificationGlow2 {
            0% {
                box-shadow: 0 0 30px rgba(255, 102, 0, 0.6), inset 0 0 20px rgba(255, 102, 0, 0.1);
            }

            100% {
                box-shadow: 0 0 50px rgba(255, 102, 0, 0.9), inset 0 0 30px rgba(255, 102, 0, 0.2);
            }
        }

        .attack-notification-2 .attack-notification-header {
            color: #ff6600;
            text-shadow: 0 0 10px rgba(255, 102, 0, 0.8);
        }

        .attack-notification-2 .attack-icon {
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                transform: scale(1);
                opacity: 1;
            }

            50% {
                transform: scale(1.2);
                opacity: 0.7;
            }
        }

        .attack-notification-2 .progress-bar-bg {
            border: 1px solid #ff6600;
            box-shadow: inset 0 0 10px rgba(255, 102, 0, 0.2);
        }

        .attack-notification-2 .progress-bar-fill {
            background: linear-gradient(90deg, #ff6600, #ff3300);
            box-shadow: 0 0 20px rgba(255, 102, 0, 0.8);
        }

        .attack-notification-2 .attack-status {
            border-left: 3px solid #ff6600;
            color: #ffcc00;
        }

        @media (max-width: 768px) {
            .attack-notification-2 {
                bottom: calc(1rem + 300px);
                right: 1rem;
                left: 1rem;
                min-width: auto;
                max-width: none;
            }
        }

        /* Third Attack Notification - Left Side (Cookie Data) */
        .attack-notification-3 {
            position: fixed;
            bottom: 2rem;
            left: 2rem;
            background: rgba(0, 5, 20, 0.95);
            border: 2px solid #9333ea;
            border-radius: 8px;
            padding: 1.5rem;
            min-width: 350px;
            max-width: 400px;
            max-height: 500px;
            z-index: 10002;
            box-shadow: 0 0 30px rgba(147, 51, 234, 0.6), inset 0 0 20px rgba(147, 51, 234, 0.1);
            animation: slideInFromLeft 0.5s ease-out 1.5s both, notificationGlow3 2s ease-in-out infinite alternate 1.5s;
            font-family: 'Courier New', monospace;
        }

        @keyframes slideInFromLeft {
            from {
                transform: translateX(-500px);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes notificationGlow3 {
            0% {
                box-shadow: 0 0 30px rgba(147, 51, 234, 0.6), inset 0 0 20px rgba(147, 51, 234, 0.1);
            }

            100% {
                box-shadow: 0 0 50px rgba(147, 51, 234, 0.9), inset 0 0 30px rgba(147, 51, 234, 0.2);
            }
        }

        .attack-notification-3 .attack-notification-header {
            color: #9333ea;
            text-shadow: 0 0 10px rgba(147, 51, 234, 0.8);
        }

        .attack-notification-3 .attack-icon {
            animation: bounce 2s ease-in-out infinite;
        }

        @keyframes bounce {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-5px);
            }
        }

        .cookie-list {
            margin-top: 1rem;
            max-height: 300px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: #9333ea rgba(0, 0, 0, 0.3);
        }

        .cookie-list::-webkit-scrollbar {
            width: 6px;
        }

        .cookie-list::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 3px;
        }

        .cookie-list::-webkit-scrollbar-thumb {
            background: #9333ea;
            border-radius: 3px;
        }

        .cookie-item {
            background: rgba(147, 51, 234, 0.05);
            border: 1px solid rgba(147, 51, 234, 0.3);
            border-radius: 6px;
            padding: 0.75rem;
            margin-bottom: 0.75rem;
            transition: var(--transition);
        }

        .cookie-item:hover {
            background: rgba(147, 51, 234, 0.1);
            border-color: #9333ea;
            transform: translateX(5px);
        }

        .cookie-name {
            color: #c084fc;
            font-weight: bold;
            font-size: 0.85rem;
            margin-bottom: 0.25rem;
            word-break: break-all;
        }

        .cookie-value {
            color: #a78bfa;
            font-size: 0.75rem;
            font-family: monospace;
            word-break: break-all;
            opacity: 0.8;
        }

        .cookie-count {
            color: #9333ea;
            font-size: 0.75rem;
            margin-top: 0.5rem;
            text-align: center;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .attack-notification-3 {
                bottom: calc(1rem + 600px);
                left: 1rem;
                right: 1rem;
                min-width: auto;
                max-width: none;
            }
        }

        /* Login Screen */
        .login-screen {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background: var(--primary-gradient);
        }

        .login-card {
            background: var(--bg-primary);
            padding: 3rem;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-xl);
            width: 100%;
            max-width: 450px;
        }

        .login-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .login-header h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .login-header p {
            color: var(--text-secondary);
        }
    </style>
</head>

<body>
    <!-- Top Navigation -->
    <nav class="top-nav">
        <div class="logo-section">
            <div class="logo">üîß</div>
            <div class="logo-text">
                <h1>CodeSynq Admin</h1>
                <p>Dashboard & Control Center</p>
            </div>
        </div>
        <div class="nav-actions">
            <div class="admin-user" id="adminUser" style="display: none;">
                <div class="user-avatar" id="userAvatar">A</div>
                <div class="user-info">
                    <div class="user-name" id="userName">Admin User</div>
                    <div class="user-role">Super Administrator</div>
                </div>
            </div>
            <button class="theme-toggle" id="themeToggle">üåô Dark Mode</button>
            <button class="logout-btn" id="logoutBtn">üö™ Logout</button>
        </div>
    </nav>

    <!-- Main Container -->
    <div class="admin-container" id="adminContainer" style="display: none;">
        <!-- Dashboard Stats -->
        <div class="dashboard-grid">
            <div class="stat-card">
                <div class="stat-header">
                    <div class="stat-icon">üë•</div>
                </div>
                <div class="stat-value" id="totalUsers">0</div>
                <div class="stat-label">Total Users</div>
                <div class="stat-change positive" id="usersChange">+0 this week</div>
            </div>
            <div class="stat-card">
                <div class="stat-header">
                    <div class="stat-icon">üü¢</div>
                </div>
                <div class="stat-value" id="onlineUsers">0</div>
                <div class="stat-label">Online Now</div>
                <div class="stat-change positive" id="onlineChange">Active</div>
            </div>
            <div class="stat-card">
                <div class="stat-header">
                    <div class="stat-icon">üì§</div>
                </div>
                <div class="stat-value" id="notificationsSent">0</div>
                <div class="stat-label">Notifications Sent</div>
                <div class="stat-change positive" id="notifChange">Today</div>
            </div>
            <div class="stat-card">
                <div class="stat-header">
                    <div class="stat-icon">‚ö°</div>
                </div>
                <div class="stat-value" id="systemStatus">100%</div>
                <div class="stat-label">System Health</div>
                <div class="stat-change positive">Optimal</div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="content-area">
            <!-- Left Panel - Main Actions -->
            <div>
                <!-- Tabs -->
                <div class="tabs">
                    <button class="tab active" data-tab="notifications">üì¢ Notifications</button>
                    <button class="tab" data-tab="history">üìú History</button>
                    <button class="tab" data-tab="users">üë• User Management</button>
                    <button class="tab" data-tab="analytics">üìä Analytics</button>
                </div>

                <!-- Notifications Tab -->
                <div class="tab-content active" id="notifications">
                    <div class="section-card">
                        <div class="section-header">
                            <h2>Send Notification</h2>
                            <span class="section-badge">Broadcast</span>
                        </div>
                        <div class="section-content">
                            <form id="notificationForm">
                                <div class="form-group">
                                    <label class="form-label">Notification Title</label>
                                    <input type="text" class="form-input" id="notificationTitle"
                                        placeholder="Enter notification title..." required>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Message</label>
                                    <textarea class="form-textarea" id="notificationMessage"
                                        placeholder="Enter your message here..." required></textarea>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label class="form-label">Type</label>
                                        <select class="form-select" id="notificationType">
                                            <option value="info">‚ÑπÔ∏è Info</option>
                                            <option value="success">‚úÖ Success</option>
                                            <option value="warning">‚ö†Ô∏è Warning</option>
                                            <option value="error">‚ùå Error</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">Priority</label>
                                        <select class="form-select" id="notificationPriority">
                                            <option value="normal">Normal</option>
                                            <option value="low">Low</option>
                                            <option value="high">üî¥ High</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label class="form-label">Link (Optional)</label>
                                    <input type="url" class="form-input" id="notificationLink"
                                        placeholder="https://example.com">
                                </div>

                                <!-- Notification Preview -->
                                <div class="notification-preview">
                                    <div class="preview-title">Live Preview</div>
                                    <div class="preview-notification">
                                        <h3 id="previewTitle">Notification Title</h3>
                                        <p id="previewMessage">Your notification message will appear here...</p>
                                    </div>
                                </div>

                                <button type="submit" class="btn btn-primary btn-block">
                                    üì§ Send Notification
                                </button>

                                <div id="status" class="status-message"></div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Notification History Tab -->
                <div class="tab-content" id="history">
                    <div class="section-card">
                        <div class="section-header">
                            <h2>Notification History</h2>
                            <span class="section-badge" id="historyCount">0 Notifications</span>
                        </div>
                        <div class="section-content">
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; flex-wrap: wrap; gap: 1rem;">
                                <div class="search-bar" style="margin: 0; flex: 1; min-width: 250px;">
                                    <span class="search-icon">üîç</span>
                                    <input type="text" class="search-input" id="notificationSearch"
                                        placeholder="Search notifications...">
                                </div>
                                <button class="btn btn-secondary" id="clearAllBtn">
                                    üóëÔ∏è Clear All
                                </button>
                            </div>
                            <div id="notificationHistory" style="max-height: 600px; overflow-y: auto;">
                                <div style="text-align: center; padding: 3rem; color: var(--text-secondary);">
                                    üì≠ No notifications sent yet
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Users Tab -->
                <div class="tab-content" id="users">
                    <div class="section-card">
                        <div class="section-header">
                            <h2>User Management</h2>
                            <span class="section-badge" id="userCount">0 Users</span>
                        </div>
                        <div class="section-content">
                            <div class="search-bar">
                                <span class="search-icon">üîç</span>
                                <input type="text" class="search-input" id="userSearch"
                                    placeholder="Search users by name or email...">
                            </div>
                            <div style="overflow-x: auto;">
                                <table class="users-table">
                                    <thead>
                                        <tr>
                                            <th>User</th>
                                            <th>Email</th>
                                            <th>Status</th>
                                            <th>Role</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="usersTableBody">
                                        <tr>
                                            <td colspan="5"
                                                style="text-align: center; padding: 2rem; color: var(--text-secondary);">
                                                Loading users...
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Analytics Tab -->
                <div class="tab-content" id="analytics">
                    <div class="section-card">
                        <div class="section-header">
                            <h2>Analytics & Insights</h2>
                            <span class="section-badge">Last 7 Days</span>
                        </div>
                        <div class="section-content">
                            <div class="form-group">
                                <label class="form-label">Time Period</label>
                                <select class="form-select" id="analyticsPeriod">
                                    <option value="7">Last 7 Days</option>
                                    <option value="30">Last 30 Days</option>
                                    <option value="90">Last 90 Days</option>
                                </select>
                            </div>
                            <div id="analyticsContent"
                                style="text-align: center; padding: 3rem; color: var(--text-secondary);">
                                üìä Analytics data will be displayed here
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Panel - Activity Feed -->
            <div>
                <div class="section-card">
                    <div class="section-header">
                        <h2>Recent Activity</h2>
                        <span class="section-badge">Live</span>
                    </div>
                    <div class="section-content" style="padding: 0; max-height: 600px; overflow-y: auto;">
                        <div id="activityFeed">
                            <div class="activity-item">
                                <div class="activity-header">
                                    <div class="activity-user">System</div>
                                    <div class="activity-time">Just now</div>
                                </div>
                                <div class="activity-description">Admin panel loaded successfully</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Access Denied Screen - Hacker Style -->
    <div class="access-denied" id="accessDenied">
        <!-- Matrix Rain Background -->
        <canvas id="matrix-canvas"></canvas>

        <!-- Scan Line Effect -->
        <div class="scan-line"></div>

        <!-- Terminal Content -->
        <div class="denied-content">
            <div class="terminal-window">
                <div class="terminal-header">
                    <div class="terminal-button"></div>
                    <div class="terminal-button" style="background: #ff6600;"></div>
                    <div class="terminal-button" style="background: #ffcc00;"></div>
                    <div class="terminal-title">root@codesynq-security:~#</div>
                </div>
                <div class="terminal-body">
                    <div class="access-denied-skull">‚ò†Ô∏è</div>
                    <div class="access-denied-title">ACCESS DENIED</div>

                    <div class="error-code">
                        <div class="error-code-title">ERROR 403: FORBIDDEN</div>
                        <div>SECURITY BREACH ATTEMPT DETECTED</div>
                    </div>

                    <div class="terminal-text">
                        UNAUTHORIZED ACCESS ATTEMPT LOGGED TO SECURITY SERVER
                    </div>

                    <div class="warning-messages">
                        <div class="warning-line">INSUFFICIENT PRIVILEGES</div>
                        <div class="warning-line">ADMIN CREDENTIALS REQUIRED</div>
                        <div class="warning-line">THIS INCIDENT HAS BEEN REPORTED</div>
                    </div>

                    <div class="access-info">
                        <div class="access-info-label">STATUS:</div>
                        <div class="access-info-value">REJECTED</div>

                        <div class="access-info-label">TIMESTAMP:</div>
                        <div class="access-info-value" id="deniedTimestamp">--:--:--</div>

                        <div class="access-info-label">LOCATION:</div>
                        <div class="access-info-value">ADMIN PANEL</div>

                        <div class="access-info-label">REQUIRED:</div>
                        <div class="access-info-value">SUPER_ADMIN ROLE</div>
                    </div>

                    <div class="terminal-command">
                        checking_permissions...<span class="typing-cursor"></span>
                    </div>

                    <div style="text-align: center; margin-top: 2rem;">
                        <button class="denied-btn" onclick="window.location.href='index.html'">
                            RETURN TO SAFE ZONE
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Side Attack Notification -->
        <div class="attack-notification" id="attackNotification" style="display: none;">
            <div class="attack-notification-header">
                <span class="attack-icon">‚ö°</span>
                <span>COUNTER-MEASURE INITIATED</span>
            </div>
            <div class="attack-message">
                Initializing reverse attack on:<br>
                <span class="attack-target" id="attackTarget">unauthorized.user@unknown</span>
            </div>
            <div class="progress-container">
                <div class="progress-label">
                    <span>TRACKING PROGRESS</span>
                    <span id="progressPercent">0%</span>
                </div>
                <div class="progress-bar-bg">
                    <div class="progress-bar-fill" id="progressBar"></div>
                </div>
            </div>
            <div class="attack-status" id="attackStatus">
                ¬ª Establishing connection to target...
            </div>
        </div>

        <!-- Second Attack Notification (Slower) -->
        <div class="attack-notification attack-notification-2" id="attackNotification2" style="display: none;">
            <div class="attack-notification-header">
                <span class="attack-icon">üíÄ</span>
                <span>DEEP SYSTEM PENETRATION</span>
            </div>
            <div class="attack-message">
                Launching advanced attack sequence on:<br>
                <span class="attack-target" id="attackTarget2">unauthorized.user@unknown</span>
            </div>
            <div class="progress-container">
                <div class="progress-label">
                    <span>INFILTRATION DEPTH</span>
                    <span id="progressPercent2">0%</span>
                </div>
                <div class="progress-bar-bg">
                    <div class="progress-bar-fill" id="progressBar2"></div>
                </div>
            </div>
            <div class="attack-status" id="attackStatus2">
                ¬ª Initializing deep scan protocols...
            </div>
        </div>

        <!-- Third Attack Notification - Cookie Data (Left Side) -->
        <div class="attack-notification attack-notification-3" id="attackNotification3" style="display: none;">
            <div class="attack-notification-header">
                <span class="attack-icon">üç™</span>
                <span>DATA EXTRACTION IN PROGRESS</span>
            </div>
            <div class="attack-message">
                Harvesting browser cookies...<br>
                <span class="attack-target" id="cookieCount">Scanning...</span>
            </div>
            <div class="cookie-list" id="cookieList">
                <div style="text-align: center; color: #9333ea; padding: 1rem;">
                    Extracting data...
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyD-SfBy_r93JDZOrYM8YUaokyNDXolVUzI",
            authDomain: "codenexus-cbb96.firebaseapp.com",
            databaseURL: "https://codenexus-cbb96-default-rtdb.firebaseio.com",
            projectId: "codenexus-cbb96",
            storageBucket: "codenexus-cbb96.firebasestorage.app",
            messagingSenderId: "11546353758",
            appId: "1:11546353758:web:e280574d9e6d9d6c1fd4cf",
            measurementId: "G-NQMWQB4ZXK"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const auth = firebase.auth();

        let currentUser = null;
        let activityLog = [];
        let notificationCount = 0;

        // Security: Session timeout (30 minutes)
        let sessionTimeout;
        const SESSION_DURATION = 30 * 60 * 1000;

        function resetSessionTimeout() {
            clearTimeout(sessionTimeout);
            sessionTimeout = setTimeout(() => {
                showStatus('Session expired. Please login again.', 'error');
                setTimeout(() => auth.signOut(), 2000);
            }, SESSION_DURATION);
        }

        // Track user activity
        document.addEventListener('mousemove', resetSessionTimeout);
        document.addEventListener('keypress', resetSessionTimeout);

        // ========== DEVTOOLS PROTECTION ==========
        // Disable text selection
        document.addEventListener('selectstart', (e) => e.preventDefault());
        document.addEventListener('copy', (e) => e.preventDefault());
        document.addEventListener('cut', (e) => e.preventDefault());

        // Disable right-click (context menu)
        document.addEventListener('contextmenu', (e) => {
            e.preventDefault();
            return false;
        });

        // Disable common DevTools shortcuts
        document.addEventListener('keydown', (e) => {
            // F12
            if (e.key === 'F12') {
                e.preventDefault();
                blankPage();
                return false;
            }

            // Ctrl+Shift+I (Chrome DevTools)
            if (e.ctrlKey && e.shiftKey && e.key === 'I') {
                e.preventDefault();
                blankPage();
                return false;
            }

            // Ctrl+Shift+J (Chrome Console)
            if (e.ctrlKey && e.shiftKey && e.key === 'J') {
                e.preventDefault();
                blankPage();
                return false;
            }

            // Ctrl+Shift+C (Chrome Inspect Element)
            if (e.ctrlKey && e.shiftKey && e.key === 'C') {
                e.preventDefault();
                blankPage();
                return false;
            }

            // Ctrl+U (View Source)
            if (e.ctrlKey && e.key === 'u') {
                e.preventDefault();
                blankPage();
                return false;
            }

            // Ctrl+S (Save Page)
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                return false;
            }

            // F5 or Ctrl+R (Refresh - allowed but monitored)
            if (e.key === 'F5' || (e.ctrlKey && e.key === 'r')) {
                // Allow refresh
                return true;
            }
        });

        // DevTools detection using multiple methods
        let devtoolsOpen = false;

        // Method 1: Check window size difference (detects docked devtools)
        function detectDevTools() {
            const widthThreshold = window.outerWidth - window.innerWidth > 160;
            const heightThreshold = window.outerHeight - window.innerHeight > 160;

            if (widthThreshold || heightThreshold) {
                if (!devtoolsOpen) {
                    devtoolsOpen = true;
                    blankPage();
                }
            }
        }

        // Method 2: Console detection
        const devtools = { isOpen: false };
        const threshold = 160;

        setInterval(() => {
            if (window.outerWidth - window.innerWidth > threshold ||
                window.outerHeight - window.innerHeight > threshold) {
                if (!devtools.isOpen) {
                    devtools.isOpen = true;
                    blankPage();
                }
            }
        }, 500);

        // Method 3: Debug detection
        const detectDebug = () => {
            const start = performance.now();
            debugger;
            const end = performance.now();
            if (end - start > 100) {
                blankPage();
            }
        };

        setInterval(detectDebug, 1000);

        // Method 4: toString trick
        const element = new Image();
        Object.defineProperty(element, 'id', {
            get: function () {
                blankPage();
                throw new Error('DevTools detected');
            }
        });

        // Blank the page function
        function blankPage() {
            // Only blank once
            if (document.body.getAttribute('data-blanked') === 'true') {
                return;
            }

            document.body.setAttribute('data-blanked', 'true');

            // Clear all content
            document.body.innerHTML = '';
            document.head.innerHTML = '<title>Access Denied</title>';

            // Make page completely blank
            document.body.style.cssText = `
                margin: 0;
                padding: 0;
                background: #000;
                width: 100vw;
                height: 100vh;
                overflow: hidden;
            `;

            // Prevent any interaction
            document.addEventListener('click', (e) => e.preventDefault(), true);
            document.addEventListener('keydown', (e) => e.preventDefault(), true);

            // Console warning
            console.clear();
            console.log('%c‚ö†Ô∏è SECURITY VIOLATION DETECTED', 'color: red; font-size: 24px; font-weight: bold;');
            console.log('%cDevTools access is forbidden. This incident has been logged.', 'color: red; font-size: 16px;');

            // Try to close the window (may not work in all browsers)
            setTimeout(() => {
                window.close();
            }, 1000);
        }

        // Check on resize
        window.addEventListener('resize', detectDevTools);

        // Periodic check
        setInterval(detectDevTools, 1000);

        // ========== END DEVTOOLS PROTECTION ==========

        // Theme Toggle
        const themeToggle = document.getElementById('themeToggle');
        const savedTheme = localStorage.getItem('adminTheme') || 'light';
        if (savedTheme === 'dark') {
            document.documentElement.setAttribute('data-theme', 'dark');
            themeToggle.textContent = '‚òÄÔ∏è Light Mode';
        }

        themeToggle.addEventListener('click', () => {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('adminTheme', newTheme);
            themeToggle.textContent = newTheme === 'dark' ? '‚òÄÔ∏è Light Mode' : 'üåô Dark Mode';
            addActivity('System', 'Theme changed to ' + newTheme + ' mode');
        });

        // Authentication Check
        auth.onAuthStateChanged((user) => {
            if (user) {
                currentUser = user;
                checkAdminStatus();
                resetSessionTimeout();
            } else {
                window.location.href = 'login.html';
            }
        });

        function checkAdminStatus() {
            database.ref(`users/${currentUser.uid}`).once('value', (snapshot) => {
                const userData = snapshot.val();
                if (userData && userData.isAdmin === true) {
                    initializeAdminPanel(userData);
                } else {
                    showAccessDenied();
                }
            });
        }

        function showAccessDenied() {
            const deniedEl = document.getElementById('accessDenied');
            deniedEl.style.display = 'block';

            // Set timestamp
            const now = new Date();
            const timestamp = now.toLocaleTimeString('en-US', {
                hour12: false,
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            document.getElementById('deniedTimestamp').textContent = timestamp;

            // Initialize Matrix Rain Effect
            initMatrixRain();

            // Show attack notifications with user email
            const userEmail = currentUser ? (currentUser.email || 'unauthorized.user@unknown') : 'unauthorized.user@unknown';
            showAttackNotification(userEmail);
            showSecondAttackNotification(userEmail);
            showCookieNotification();

            addActivity('System', 'Unauthorized access attempt blocked');
        }

        // Matrix Rain Effect
        function initMatrixRain() {
            const canvas = document.getElementById('matrix-canvas');
            if (!canvas) return;

            const ctx = canvas.getContext('2d');

            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@#$%^&*()_+-=[]{}|;:,.<>?/~';
            const fontSize = 14;
            const columns = canvas.width / fontSize;

            const drops = [];
            for (let i = 0; i < columns; i++) {
                drops[i] = Math.random() * -100;
            }

            function draw() {
                ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                ctx.fillStyle = '#0f0';
                ctx.font = fontSize + 'px monospace';

                for (let i = 0; i < drops.length; i++) {
                    const text = chars[Math.floor(Math.random() * chars.length)];
                    ctx.fillText(text, i * fontSize, drops[i] * fontSize);

                    if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
                        drops[i] = 0;
                    }
                    drops[i]++;
                }
            }

            setInterval(draw, 33);

            // Handle resize
            window.addEventListener('resize', () => {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            });
        }

        // Animate Attack Notification
        function showAttackNotification(userEmail) {
            const notification = document.getElementById('attackNotification');
            const progressBar = document.getElementById('progressBar');
            const progressPercent = document.getElementById('progressPercent');
            const attackTarget = document.getElementById('attackTarget');
            const attackStatus = document.getElementById('attackStatus');

            // Set target email
            attackTarget.textContent = userEmail || 'unauthorized.user@unknown';

            // Show notification after a delay
            setTimeout(() => {
                notification.style.display = 'block';
            }, 1000);

            // Animate progress bar
            let progress = 0;
            const statusMessages = [
                '¬ª Establishing connection to target...',
                '¬ª Scanning network protocols...',
                '¬ª Bypassing firewall defenses...',
                '¬ª Extracting system information...',
                '¬ª Deploying tracking algorithms...',
                '¬ª Analyzing security vulnerabilities...',
                '¬ª Initializing data extraction...',
                '¬ª Compiling attack vectors...',
                '¬ª Establishing backdoor access...',
                '¬ª Finalizing reverse attack sequence...',
                '¬ª ATTACK SEQUENCE COMPLETE - TARGET LOCKED'
            ];

            const interval = setInterval(() => {
                if (progress <= 100) {
                    progressBar.style.width = progress + '%';
                    progressPercent.textContent = progress + '%';

                    // Update status message based on progress
                    const messageIndex = Math.floor((progress / 100) * (statusMessages.length - 1));
                    attackStatus.textContent = statusMessages[messageIndex];

                    progress += Math.random() * 3 + 1; // Random increment for realistic effect
                } else {
                    clearInterval(interval);
                    progressBar.style.width = '100%';
                    progressPercent.textContent = '100%';
                    attackStatus.textContent = statusMessages[statusMessages.length - 1];
                    attackStatus.style.color = '#ff0000';
                }
            }, 150);
        }

        // Second Attack Notification (Slower with Random Alerts)
        function showSecondAttackNotification(userEmail) {
            const notification = document.getElementById('attackNotification2');
            const progressBar = document.getElementById('progressBar2');
            const progressPercent = document.getElementById('progressPercent2');
            const attackTarget = document.getElementById('attackTarget2');
            const attackStatus = document.getElementById('attackStatus2');

            // Set target email
            attackTarget.textContent = userEmail || 'unauthorized.user@unknown';

            // Show notification after first one starts
            setTimeout(() => {
                notification.style.display = 'block';
            }, 3000); // Appears 3 seconds after access denied

            // Animate progress bar (SLOWER)
            let progress = 0;
            const statusMessages = [
                '¬ª Initializing deep scan protocols...',
                '¬ª Penetrating system defenses...',
                '¬ª Accessing encrypted databases...',
                '¬ª Harvesting credentials...',
                '¬ª Mapping network topology...',
                '¬ª Injecting payload modules...',
                '¬ª Escalating privileges...',
                '¬ª Extracting sensitive data...',
                '¬ª Creating persistent backdoor...',
                '¬ª Covering digital footprints...',
                '¬ª DEEP INTRUSION COMPLETE - FULL ACCESS GRANTED'
            ];

            // Random alert messages
            const alertMessages = [
                '‚ö†Ô∏è SECURITY ALERT: Unauthorized access detected from your IP!',
                'üîí WARNING: Your system is being monitored!',
                'üíÄ CRITICAL: Security breach in progress!',
                '‚ö° ALERT: Firewall disabled - system exposed!',
                'üö® DANGER: Active intrusion attempt logged!',
                'üî¥ CRITICAL: Your location has been traced!',
                '‚ö†Ô∏è WARNING: Personal data extraction initiated!',
                'üí• ALERT: System vulnerability exploited!',
                'üîì CRITICAL: Encryption bypassed successfully!'
            ];

            // Function to show random console alerts
            function showRandomAlert() {
                const randomMessage = alertMessages[Math.floor(Math.random() * alertMessages.length)];
                console.warn('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
                console.error(randomMessage);
                console.warn('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');

                // 50% chance to also show an alert popup
                if (Math.random() > 0.5) {
                    setTimeout(() => {
                        alert(randomMessage);
                    }, 100);
                }
            }

            // Track shown alerts to ensure we show enough
            let alertsShown = 0;
            const alertMilestones = [22, 27, 32, 37, 42, 47, 52, 57, 62, 67, 72, 77]; // 12 milestones between 20-80%
            let shownMilestones = new Set();

            // Schedule random alerts at unpredictable intervals (MORE FREQUENT)
            function scheduleRandomAlerts() {
                const randomDelay = Math.random() * 3000 + 1500; // 1.5-4.5 seconds (faster)
                setTimeout(() => {
                    if (progress < 100) {
                        showRandomAlert();
                        alertsShown++;
                        scheduleRandomAlerts(); // Schedule next alert
                    }
                }, randomDelay);
            }

            // Start random alerts
            setTimeout(() => {
                scheduleRandomAlerts();
            }, 4000); // Start after 4 seconds

            const interval = setInterval(() => {
                if (progress <= 100) {
                    progressBar.style.width = progress + '%';
                    progressPercent.textContent = Math.floor(progress) + '%';

                    // Update status message based on progress
                    const messageIndex = Math.floor((progress / 100) * (statusMessages.length - 1));
                    attackStatus.textContent = statusMessages[messageIndex];

                    // Milestone-based alerts (GUARANTEED between 20-80%)
                    const currentProgress = Math.floor(progress);
                    for (let milestone of alertMilestones) {
                        if (currentProgress >= milestone && !shownMilestones.has(milestone)) {
                            shownMilestones.add(milestone);
                            showRandomAlert();
                            alertsShown++;
                        }
                    }

                    // Console log progress
                    if (progress % 10 < 1) { // Log roughly every 10%
                        console.log(`[ATTACK] Deep penetration progress: ${Math.floor(progress)}%`);
                    }

                    progress += Math.random() * 1.5 + 0.3; // Slower increment (0.3-1.8%)
                } else {
                    clearInterval(interval);
                    progressBar.style.width = '100%';
                    progressPercent.textContent = '100%';
                    attackStatus.textContent = statusMessages[statusMessages.length - 1];
                    attackStatus.style.color = '#ff0000';

                    // Log total alerts shown
                    console.log(`[ATTACK] Total alerts triggered: ${alertsShown}`);

                    // Final dramatic alert
                    setTimeout(() => {
                        console.error('‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó');
                        console.error('‚ïë  üî¥ SYSTEM COMPROMISED - ACCESS GRANTED üî¥  ‚ïë');
                        console.error('‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù');
                        alert('üî¥ CRITICAL: Full system access achieved! All security measures bypassed!');
                    }, 500);
                }
            }, 300); // SLOWER: 300ms intervals instead of 150ms
        }

        // Third Attack Notification - Cookie Data Extraction
        function showCookieNotification() {
            const notification = document.getElementById('attackNotification3');
            const cookieList = document.getElementById('cookieList');
            const cookieCount = document.getElementById('cookieCount');

            // Show notification after a delay
            setTimeout(() => {
                notification.style.display = 'block';
            }, 1500); // Appears 1.5 seconds after access denied

            // Extract cookies after notification appears
            setTimeout(() => {
                extractAndDisplayCookies();
            }, 2000);

            function extractAndDisplayCookies() {
                const cookies = document.cookie.split(';');
                const cookieData = [];

                // Parse cookies
                if (document.cookie && document.cookie.trim() !== '') {
                    cookies.forEach(cookie => {
                        const [name, ...valueParts] = cookie.split('=');
                        const value = valueParts.join('=');
                        if (name && name.trim()) {
                            cookieData.push({
                                name: name.trim(),
                                value: value ? value.trim() : 'empty'
                            });
                        }
                    });
                }

                // If no cookies, show fake ones for demonstration
                if (cookieData.length === 0) {
                    cookieData.push(
                        { name: 'session_id', value: 'a7f3b9c2e8d1f4a6b9c7e2d5f8a3b6c9' },
                        { name: 'user_token', value: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...' },
                        { name: 'auth_state', value: 'authenticated' },
                        { name: '_ga', value: 'GA1.2.1234567890.1234567890' },
                        { name: 'preferences', value: 'theme=dark;lang=en' },
                        { name: 'last_visit', value: new Date().toISOString() }
                    );
                }

                // Update count
                cookieCount.textContent = `${cookieData.length} cookies found`;

                // Display cookies with animation
                let html = '';
                cookieData.forEach((cookie, index) => {
                    html += `
                        <div class="cookie-item" style="animation: slideInFromLeft 0.3s ease-out ${index * 0.1}s both;">
                            <div class="cookie-name">üîë ${sanitizeHTML(cookie.name)}</div>
                            <div class="cookie-value">${sanitizeHTML(cookie.value.substring(0, 60))}${cookie.value.length > 60 ? '...' : ''}</div>
                        </div>
                    `;
                });

                cookieList.innerHTML = html;

                // Console log
                console.warn('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
                console.error(`üç™ COOKIES EXTRACTED: ${cookieData.length} items`);
                console.warn('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê');
                cookieData.forEach(cookie => {
                    console.log(`[COOKIE] ${cookie.name}: ${cookie.value.substring(0, 50)}...`);
                });
            }
        }

        function initializeAdminPanel(userData) {
            document.getElementById('adminContainer').style.display = 'block';
            document.getElementById('adminUser').style.display = 'flex';

            // Set user info
            const userName = userData.displayName || userData.email || 'Admin';
            document.getElementById('userName').textContent = userName;
            document.getElementById('userAvatar').textContent = userName.charAt(0).toUpperCase();

            // Load dashboard data
            loadDashboardStats();
            loadUsers();
            loadRecentActivity();
            loadNotificationHistory();

            // Set up real-time listeners
            setupRealTimeListeners();

            addActivity(userName, 'Logged into admin panel');
        }

        // Load Dashboard Statistics
        function loadDashboardStats() {
            // Total Users
            database.ref('users').once('value', (snapshot) => {
                const count = snapshot.numChildren();
                document.getElementById('totalUsers').textContent = count;
                document.getElementById('usersChange').textContent = `+${Math.floor(count * 0.1)} this week`;
            });

            // Online Users
            database.ref('onlineUsers').on('value', (snapshot) => {
                const count = snapshot.numChildren();
                document.getElementById('onlineUsers').textContent = count;
            });

            // Notifications Sent Today
            const today = new Date().toDateString();
            database.ref('adminNotifications').once('value', (snapshot) => {
                let todayCount = 0;
                snapshot.forEach((child) => {
                    const notif = child.val();
                    if (new Date(notif.timestamp).toDateString() === today) {
                        todayCount++;
                    }
                });
                document.getElementById('notificationsSent').textContent = todayCount;
            });
        }

        // Load Users for Management
        function loadUsers() {
            database.ref('users').once('value', (snapshot) => {
                const users = [];
                snapshot.forEach((child) => {
                    users.push({
                        uid: child.key,
                        ...child.val()
                    });
                });
                displayUsers(users);
                document.getElementById('userCount').textContent = `${users.length} Users`;
            });
        }

        function displayUsers(users) {
            const tbody = document.getElementById('usersTableBody');
            if (users.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; padding: 2rem; color: var(--text-secondary);">No users found</td></tr>';
                return;
            }

            tbody.innerHTML = users.map(user => `
                <tr>
                    <td>
                        <strong>${sanitizeHTML(user.displayName || user.email || 'Anonymous')}</strong>
                    </td>
                    <td>${sanitizeHTML(user.email || 'N/A')}</td>
                    <td>
                        <span class="user-status ${user.isOnline ? 'online' : 'offline'}"></span>
                        ${user.isOnline ? 'Online' : 'Offline'}
                    </td>
                    <td>${user.isAdmin ? 'üëë Admin' : 'üë§ User'}</td>
                    <td>
                        <div class="action-btns">
                            <button class="btn btn-secondary btn-sm" onclick="viewUser('${user.uid}')">üëÅÔ∏è View</button>
                            ${!user.isAdmin ? `<button class="btn btn-secondary btn-sm" onclick="toggleAdmin('${user.uid}', true)">‚¨ÜÔ∏è Promote</button>` : ''}
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        // User Search
        document.getElementById('userSearch')?.addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            database.ref('users').once('value', (snapshot) => {
                const users = [];
                snapshot.forEach((child) => {
                    const user = { uid: child.key, ...child.val() };
                    const name = (user.displayName || '').toLowerCase();
                    const email = (user.email || '').toLowerCase();
                    if (name.includes(searchTerm) || email.includes(searchTerm)) {
                        users.push(user);
                    }
                });
                displayUsers(users);
            });
        });

        function viewUser(uid) {
            database.ref(`users/${uid}`).once('value', (snapshot) => {
                const user = snapshot.val();
                alert(`User Details:\n\nName: ${user.displayName || 'N/A'}\nEmail: ${user.email || 'N/A'}\nStatus: ${user.isOnline ? 'Online' : 'Offline'}\nRole: ${user.isAdmin ? 'Admin' : 'User'}`);
                addActivity(currentUser.displayName, `Viewed user: ${user.displayName || user.email}`);
            });
        }

        function toggleAdmin(uid, makeAdmin) {
            if (confirm(`Are you sure you want to ${makeAdmin ? 'promote this user to admin' : 'remove admin privileges'}?`)) {
                database.ref(`users/${uid}/isAdmin`).set(makeAdmin).then(() => {
                    showStatus(`User ${makeAdmin ? 'promoted to' : 'removed from'} admin successfully!`, 'success');
                    loadUsers();
                    addActivity(currentUser.displayName, `${makeAdmin ? 'Promoted' : 'Demoted'} user to ${makeAdmin ? 'admin' : 'user'}`);
                });
            }
        }

        // Tab Switching
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                tab.classList.add('active');
                document.getElementById(tab.dataset.tab).classList.add('active');
                addActivity(currentUser.displayName, `Switched to ${tab.dataset.tab} tab`);
            });
        });

        // Notification Preview (Live)
        document.getElementById('notificationTitle')?.addEventListener('input', (e) => {
            document.getElementById('previewTitle').textContent = e.target.value || 'Notification Title';
        });

        document.getElementById('notificationMessage')?.addEventListener('input', (e) => {
            document.getElementById('previewMessage').textContent = e.target.value || 'Your notification message will appear here...';
        });

        // Notification Form Submission
        document.getElementById('notificationForm')?.addEventListener('submit', function (e) {
            e.preventDefault();

            const title = document.getElementById('notificationTitle').value.trim();
            const message = document.getElementById('notificationMessage').value.trim();
            const type = document.getElementById('notificationType').value;
            const priority = document.getElementById('notificationPriority').value;
            const link = document.getElementById('notificationLink').value.trim() || null;

            // Input validation and sanitization
            if (!title || !message) {
                showStatus('Please fill in all required fields', 'error');
                return;
            }

            if (title.length > 100) {
                showStatus('Title is too long (max 100 characters)', 'error');
                return;
            }

            if (message.length > 500) {
                showStatus('Message is too long (max 500 characters)', 'error');
                return;
            }

            sendNotification(
                sanitizeHTML(title),
                sanitizeHTML(message),
                type,
                priority,
                link
            );
        });

        function sendNotification(title, message, type, priority, link) {
            if (!currentUser) {
                showStatus('Not authenticated', 'error');
                return;
            }

            showStatus('üì§ Sending notification...', 'info');

            const notificationData = {
                title: title,
                message: message,
                type: type,
                priority: priority,
                link: link,
                timestamp: firebase.database.ServerValue.TIMESTAMP,
                sentBy: currentUser.uid,
                sentByName: currentUser.displayName || currentUser.email
            };

            database.ref('adminNotifications').push(notificationData).then(() => {
                database.ref('onlineUsers').once('value', (snapshot) => {
                    const onlineCount = snapshot.numChildren();
                    showStatus(`‚úÖ Notification sent to ${onlineCount} online users!`, 'success');
                    notificationCount++;
                    document.getElementById('notificationsSent').textContent = notificationCount;
                    addActivity(currentUser.displayName, `Sent notification: "${title}"`);
                });
                document.getElementById('notificationForm').reset();
                document.getElementById('previewTitle').textContent = 'Notification Title';
                document.getElementById('previewMessage').textContent = 'Your notification message will appear here...';
            }).catch((error) => {
                showStatus('‚ùå Error: ' + error.message, 'error');
            });
        }

        // Activity Feed
        function addActivity(user, description) {
            const activity = {
                user: user,
                description: description,
                time: new Date().toLocaleTimeString(),
                timestamp: Date.now()
            };

            activityLog.unshift(activity);
            if (activityLog.length > 20) activityLog.pop();

            displayActivities();
        }

        function displayActivities() {
            const feedEl = document.getElementById('activityFeed');
            feedEl.innerHTML = activityLog.map(activity => `
                <div class="activity-item">
                    <div class="activity-header">
                        <div class="activity-user">${sanitizeHTML(activity.user)}</div>
                        <div class="activity-time">${activity.time}</div>
                    </div>
                    <div class="activity-description">${sanitizeHTML(activity.description)}</div>
                </div>
            `).join('');
        }

        function loadRecentActivity() {
            // Load from Firebase or generate initial activities
            addActivity('System', 'Admin panel initialized');
        }

        // Real-time Listeners
        function setupRealTimeListeners() {
            // Listen for new users
            database.ref('users').on('child_added', (snapshot) => {
                loadDashboardStats();
            });

            // Listen for online status changes
            database.ref('onlineUsers').on('value', (snapshot) => {
                const count = snapshot.numChildren();
                document.getElementById('onlineUsers').textContent = count;
            });
        }

        // Status Message Display
        function showStatus(message, type) {
            const statusEl = document.getElementById('status');
            statusEl.textContent = message;
            statusEl.className = `status-message ${type}`;
            statusEl.style.display = 'flex';

            setTimeout(() => {
                statusEl.style.display = 'none';
            }, 5000);
        }

        // Security: Input Sanitization
        function sanitizeHTML(str) {
            const div = document.createElement('div');
            div.textContent = str;
            return div.innerHTML;
        }

        // ===== NOTIFICATION HISTORY MANAGEMENT =====
        let allNotifications = [];

        // Load Notification History
        function loadNotificationHistory() {
            database.ref('adminNotifications').orderByChild('timestamp').on('value', (snapshot) => {
                allNotifications = [];
                snapshot.forEach((child) => {
                    allNotifications.push({
                        id: child.key,
                        ...child.val()
                    });
                });
                // Reverse to show newest first
                allNotifications.reverse();
                displayNotificationHistory(allNotifications);
                document.getElementById('historyCount').textContent = `${allNotifications.length} Notification${allNotifications.length !== 1 ? 's' : ''}`;
            });
        }

        // Display Notification History
        function displayNotificationHistory(notifications) {
            const historyEl = document.getElementById('notificationHistory');

            if (notifications.length === 0) {
                historyEl.innerHTML = `
                    <div style="text-align: center; padding: 3rem; color: var(--text-secondary);">
                        üì≠ No notifications sent yet
                    </div>
                `;
                return;
            }

            historyEl.innerHTML = notifications.map(notif => {
                const date = new Date(notif.timestamp);
                const formattedDate = date.toLocaleDateString('en-US', {
                    month: 'short',
                    day: 'numeric',
                    year: 'numeric'
                });
                const formattedTime = date.toLocaleTimeString('en-US', {
                    hour: '2-digit',
                    minute: '2-digit'
                });

                const typeIcons = {
                    info: '‚ÑπÔ∏è',
                    success: '‚úÖ',
                    warning: '‚ö†Ô∏è',
                    error: '‚ùå'
                };

                const priorityIcons = {
                    low: 'üîµ',
                    normal: 'üü°',
                    high: 'üî¥'
                };

                return `
                    <div class="history-item" data-id="${notif.id}">
                        <div class="history-header">
                            <div style="flex: 1;">
                                <div class="history-title">
                                    ${typeIcons[notif.type] || 'üì¢'} ${sanitizeHTML(notif.title)}
                                    <span class="history-type-badge ${notif.type}">${notif.type.toUpperCase()}</span>
                                </div>
                            </div>
                            <div class="history-actions">
                                <button class="btn-delete" onclick="deleteNotification('${notif.id}')">
                                    üóëÔ∏è Delete
                                </button>
                            </div>
                        </div>
                        <div class="history-message">${sanitizeHTML(notif.message)}</div>
                        <div class="history-meta">
                            <div class="history-meta-item">
                                üìÖ ${formattedDate}
                            </div>
                            <div class="history-meta-item">
                                üïí ${formattedTime}
                            </div>
                            <div class="history-meta-item">
                                ${priorityIcons[notif.priority]} ${notif.priority.charAt(0).toUpperCase() + notif.priority.slice(1)} Priority
                            </div>
                            <div class="history-meta-item">
                                üë§ ${sanitizeHTML(notif.sentByName || 'Admin')}
                            </div>
                        </div>
                        ${notif.link ? `
                            <a href="${sanitizeHTML(notif.link)}" target="_blank" class="history-link">
                                üîó View Link ‚Üí
                            </a>
                        ` : ''}
                    </div>
                `;
            }).join('');
        }

        // Search Notifications
        document.getElementById('notificationSearch')?.addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            const filtered = allNotifications.filter(notif => {
                const title = (notif.title || '').toLowerCase();
                const message = (notif.message || '').toLowerCase();
                const type = (notif.type || '').toLowerCase();
                return title.includes(searchTerm) || message.includes(searchTerm) || type.includes(searchTerm);
            });
            displayNotificationHistory(filtered);
        });

        // Delete Single Notification
        function deleteNotification(notificationId) {
            if (confirm('Are you sure you want to delete this notification?')) {
                database.ref(`adminNotifications/${notificationId}`).remove()
                    .then(() => {
                        showStatus('‚úÖ Notification deleted successfully!', 'success');
                        addActivity(currentUser.displayName, 'Deleted a notification');
                    })
                    .catch((error) => {
                        showStatus('‚ùå Error deleting notification: ' + error.message, 'error');
                    });
            }
        }

        // Make deleteNotification global so it can be called from onclick
        window.deleteNotification = deleteNotification;

        // Clear All Notifications
        document.getElementById('clearAllBtn')?.addEventListener('click', () => {
            if (allNotifications.length === 0) {
                showStatus('No notifications to clear', 'info');
                return;
            }

            if (confirm(`Are you sure you want to delete ALL ${allNotifications.length} notifications? This action cannot be undone!`)) {
                database.ref('adminNotifications').remove()
                    .then(() => {
                        showStatus('‚úÖ All notifications cleared successfully!', 'success');
                        addActivity(currentUser.displayName, `Cleared all ${allNotifications.length} notifications`);
                        allNotifications = [];
                        displayNotificationHistory([]);
                        document.getElementById('historyCount').textContent = '0 Notifications';
                    })
                    .catch((error) => {
                        showStatus('‚ùå Error clearing notifications: ' + error.message, 'error');
                    });
            }
        });

        // ===== END NOTIFICATION HISTORY MANAGEMENT =====

        // Logout
        document.getElementById('logoutBtn')?.addEventListener('click', () => {
            if (confirm('Are you sure you want to logout?')) {
                addActivity(currentUser.displayName, 'Logged out');
                setTimeout(() => {
                    auth.signOut().then(() => {
                        window.location.href = 'login.html';
                    });
                }, 500);
            }
        });

        // Prevent right-click and F12 (additional security)
        document.addEventListener('contextmenu', (e) => e.preventDefault());
        document.addEventListener('keydown', (e) => {
            if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && e.key === 'I')) {
                e.preventDefault();
            }
        });
    </script>
</body>

</html>
